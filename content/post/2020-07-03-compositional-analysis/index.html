---
title: 'Metallurgical compositional analysis'
author: ''
date: '2020-07-03'
slug: compositional-analysis
categories: []
tags: []
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>
<script src="{{< blogdown/postref >}}index_files/htmlwidgets/htmlwidgets.js"></script>
<script src="{{< blogdown/postref >}}index_files/plotly-binding/plotly.js"></script>
<script src="{{< blogdown/postref >}}index_files/typedarray/typedarray.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/jquery/jquery.min.js"></script>
<link href="{{< blogdown/postref >}}index_files/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/crosstalk/js/crosstalk.min.js"></script>
<link href="{{< blogdown/postref >}}index_files/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/plotly-main/plotly-latest.min.js"></script>


<pre class="r"><code>divide01 &lt;- function(x){
  return(x/100)
}

data &lt;- read.csv(&quot;hardness.csv&quot;) %&gt;% 
  mutate(Al=divide01(Al),
         Co=divide01(Co),
         Cr=divide01(Cr),
         Cu=divide01(Cu),
         Fe=divide01(Fe),
         Ni=divide01(Ni))
data_ordered &lt;- read.csv(&quot;hardness.csv&quot;) %&gt;% 
  mutate(Al=divide01(Al),
         Co=divide01(Co),
         Cr=divide01(Cr),
         Cu=divide01(Cu),
         Fe=divide01(Fe),
         Ni=divide01(Ni)) %&gt;% 
  arrange(desc(hardness))

closed &lt;- clo(data, parts = 1:6,total=100)
cx &lt;- acomp(data, c(&quot;Al&quot;,&quot;Co&quot;,&quot;Cr&quot;))
plot(cx)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>xc &lt;- acomp(data, c(&quot;Al&quot;,&quot;Co&quot;,&quot;Cr&quot;,&quot;Cu&quot;,&quot;Fe&quot;,&quot;Ni&quot;))
xc_ordered &lt;- acomp(data_ordered, c(&quot;Al&quot;,&quot;Co&quot;,&quot;Cr&quot;,&quot;Cu&quot;,&quot;Fe&quot;,&quot;Ni&quot;))
plot(xc)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<pre class="r"><code>barplot.acomp(xc)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-2-3.png" width="672" /></p>
<p>Order of hardness desc</p>
<pre class="r"><code>barplot.acomp(xc_ordered)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Possibly drop copper and nickel</p>
<pre class="r"><code>library(httr)
raw_dd &lt;- read.table(text=content(GET(&quot;https://gist.githubusercontent.com/MrFlick/c1183c911bc5398105d4/raw/715868fba2d0d17a61a8081de17c468bbc525ab1/elements.txt&quot;)), sep=&quot;,&quot;, header=TRUE) %&gt;%
  mutate(ElementName=ifelse(ElementName==&quot;Sulfer&quot;,&quot;Sulfur&quot;,ElementName),
         ElementName=ifelse(ElementName==&quot;Phosphorous&quot;,&quot;Phosphorus&quot;,ElementName),
         ElementName=ifelse(ElementName==&quot;Flourine&quot;,&quot;Fluorine&quot;,ElementName))
data &lt;- read_xlsx(&quot;melting_points.xlsx&quot;, sheet = &#39;Sheet2&#39;)
colnames(raw_dd) &lt;- c(colnames(raw_dd)[1:7],&quot;element&quot;,colnames(raw_dd)[9:13])</code></pre>
<pre class="r"><code>dd &lt;- raw_dd %&gt;%
  left_join(data, by = &quot;element&quot;) %&gt;%
  mutate(CTE_ppm=CTE*1000000,
         CTE_ppm=as.numeric(CTE_ppm),
         scaled_cte=CTE_ppm,
         scaled_cte=ifelse(scaled_cte&gt;8,8,scaled_cte),
         scaled_cte=ifelse(scaled_cte&lt;4.5,4.4,scaled_cte),
         new_structure=ifelse(crystal_structure %in% c(&quot;Body-centered Cubic&quot;,&quot;Face-centered Cubic&quot;,&quot;Simple Hexagonal&quot;),crystal_structure,NA))</code></pre>
<pre class="r"><code>dd %&gt;%
  ggplot(aes(Column,-Row)) +
  geom_tile(aes(fill=crystal_structure), color=&quot;black&quot;) +
  geom_text(aes(Column, -Row,label= symbol))+
  theme_void()+
  labs(
    fill = &quot;Crystal Structure&quot;
  ) +
  annotate(&quot;text&quot;, x = 7, y = 0.2, label = &quot;Periodic Table of the elements&quot;, size = 5)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>(p&lt;-dd %&gt;%
  filter(!is.na(symbol)) %&gt;%
  #filter(!crystal_structure %in% c(&quot;Base-centered Monoclinic&quot;,&quot;Centered Tetragonal&quot;)) %&gt;%
  ggplot(aes(Column, -Row))+
  geom_tile(aes(fill=scaled_cte), color=&quot;black&quot;,size=1) +
  geom_rect(aes(xmin=Column-0.3,xmax=Column+0.3,ymin=-Row-0.2,ymax=-Row+0.3,colour=new_structure),size=1,lty=1,fill=&quot;black&quot;)+
    #geom_text(aes(label=&quot;&quot;,colour=new_structure), na.rm = T,size=12,nudge_y = 0.3)+
  geom_text(aes(label=symbol),colour=&quot;yellow&quot;,nudge_y = +0.05)+
  geom_text(aes(label=CTE_ppm),colour=&quot;black&quot;,nudge_y = -0.35)+
  scale_fill_gradient(low = &quot;red&quot;,high = &quot;green&quot;)+
  labs(fill = expression(paste(&quot;CTE&quot;, 10^6)),
    colour=&quot;&quot;) +
  annotate(&quot;text&quot;, x = 7, y = 0.2, label = &quot;Periodic Table of the elements&quot;, size = 5))+
  theme_void()+
  theme(legend.position=&quot;bottom&quot;)+
  scale_colour_discrete(na.translate = F)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>f1 &lt;- function(x){
  return(1/(16.6*3*(x+273)))
}

library(plotly)
library(ggrepel)
data %&gt;% 
  ggplot(aes(mp, CTE, label=element))+
  geom_point()+
  stat_function(fun=f1)+
  lims(
    x=c(1500,4000),
    y=c(0,0.000025)
  )+
  theme(legend.position = &quot;none&quot;)+
  ggrepel::geom_text_repel()+
  theme_bw()</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div id="predictive-modelling" class="section level1">
<h1>Predictive modelling</h1>
<p>Compositional data can be transformed to satisfy linearity by using logratio transformations for representation in a Euclidean space. Additive, isometric, and centre logratio transformations are available.</p>
<p>The transformations give the same coefficients for the multi-variate regressions so we will stick with the additive logratio defined as: <span class="math display">\[alr(x) = \left [\log\frac{x_1}{x_n},\ldots,\log\frac{x_{n-1}}{x_n}\right]\]</span></p>
<p>These transformation functions are available within the ‘compositions’ R package. Ratio transformations have issues with zero-value elements.</p>
<p>PRINCIPLES OF COMPOSITIONAL DATA ANALYSIS
BY JOHN AITCHISON</p>
<pre class="r"><code>library(compositions)

library(caret)

library(glmnet)
hard &lt;- read_csv(&quot;hardness.csv&quot;)
#hard %&gt;% arrange(-hardness)</code></pre>
<pre class="r"><code># Filtering out zero values for logratio transformations
hard_ &lt;- hard %&gt;% 
  filter(Al &gt; 0, Co &gt; 0, Cr &gt; 0, Cu &gt; 0, Fe &gt; 0, Ni &gt; 0)
  #mutate(Al = ifelse(Al == 0, 1, Al),
  #        Co = ifelse(Co == 0, 1, Co),
  #        Cr = ifelse(Cr == 0, 1, Cr),
  #        Cu = ifelse(Cu == 0, 1, Cu),
  #        Fe = ifelse(Fe == 0, 1, Fe),
  #        Ni = ifelse(Ni == 0, 1, Ni))</code></pre>
<pre class="r"><code># Setting x, y


y &lt;- hard_$hardness
x &lt;- hard_[,1:ncol(hard)-1]</code></pre>
<pre class="r"><code>hard.clr &lt;- x %&gt;% 
  clr()
hard.ilr &lt;- x %&gt;% 
  ilr()
hard.alr &lt;- x %&gt;% 
  alr()</code></pre>
<pre class="r"><code>#predict(hard.clr.lm,clr(v))

hard.clr.lm &lt;- lm(y ~ ., cbind(y,hard.clr) %&gt;% data.frame())
hard.ilr.lm &lt;- lm(y ~ ., cbind(y,hard.ilr) %&gt;% data.frame())
hard.alr.lm &lt;- lm(y ~ ., cbind(y,hard.alr) %&gt;% data.frame())</code></pre>
<pre class="r"><code>hard.ilr.glm.model &lt;- cv.glmnet(hard.ilr, y, alpha = 1)
hard.ilr.glm &lt;- glmnet(hard.ilr, y, alpha = 1, lambda = hard.ilr.glm.model$lambda.min)</code></pre>
<pre class="r"><code>dataset &lt;- cbind(data.frame(hardness = y),hard.clr) %&gt;% data.frame()

hard.clr.gam &lt;- gam(hardness ~ Al+ Co + Co + Cr + Cu + Fe + Ni, data = dataset)</code></pre>
<pre class="r"><code>predictions.full &lt;- data.frame(hard_) %&gt;% 
  mutate(prediction.clr.lm = predict(hard.clr.lm, newx = hard_),
         prediction.ilr.lm = predict(hard.ilr.lm, newx = hard.ilr),
         #prediction.alr.lm = predict(hard.alr.lm, newx = hard.alr),
         prediction.ilr.glm = predict(hard.ilr.glm, best_lambda = hard.ilr.glm.model$lambda.min, newx = hard.ilr),
         prediction.clr.gam = predict(hard.clr.gam, newx = hard.clr),
         pre = predict(hard.clr.lm, newx = row()))</code></pre>
<pre class="r"><code># predictions.full %&gt;% colnames

predictions.full %&gt;% 
  arrange(hardness) %&gt;% 
  mutate(row_name = row_number()) %&gt;% 
  pivot_longer(c(hardness, prediction.clr.lm,prediction.ilr.glm, prediction.clr.gam), names_to = &quot;variable&quot;,values_to = &quot;value&quot;) %&gt;% 
  ggplot(aes(row_name, value, colour = variable, shape = variable))+
  geom_point(alpha = 0.8)+
  labs(title = &quot;Hardness prediction&quot;,
       subtitle = &quot;Comparing hardness prediction.clr.lm and actual hardness&quot;,
       y = &quot;hardness&quot;,
       x = &quot;rank ordered by ascending hardness&quot;)+
  #annotate(&quot;text&quot;, y = 200, x = 25,label = paste(&quot;RMSE = &quot;,
   # round(RMSE(predictions.full$prediction.clr.lm, predictions.full$hardness),2)
  #))+
  theme_bw()+
  theme(legend.position = c(0.8,0.2),
        legend.background = element_rect(fill = &quot;white&quot;, color = &quot;black&quot;))+
  scale_color_discrete(name = paste(&quot;RMSE = &quot;, round(RMSE(predictions.full$prediction.clr.lm, predictions.full$hardness),2)))+
  scale_shape_discrete(name = paste(&quot;RMSE = &quot;, round(RMSE(predictions.full$prediction.clr.lm, predictions.full$hardness),2)))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code># Linear regression on ILR logratio transformation  
RMSE(predictions.full$prediction.clr.lm, predictions.full$hardness)</code></pre>
<pre><code>## [1] 63.40838</code></pre>
<pre class="r"><code># Lasso regression on ILR logratio transformation
RMSE(predictions.full$prediction.ilr.glm, predictions.full$hardness)</code></pre>
<pre><code>## [1] 65.40847</code></pre>
<pre class="r"><code># generalised additive model
RMSE(predictions.full$prediction.clr.gam, predictions.full$hardness)</code></pre>
<pre><code>## [1] 63.40838</code></pre>
<pre class="r"><code># library(robCompositions)
# aDist(x = hard_[,1:ncol(hard)-1])
#Compositional::alfa.ridge(as.matrix(y), as.matrix(x),a = 0.01, lambda = 1)</code></pre>
</div>
<div id="principal-component-analysis-for-compositional-data-vectors" class="section level1">
<h1>Principal component analysis for compositional data vectors</h1>
<p><a href="https://link.springer.com/article/10.1007/s00180-015-0570-1" class="uri">https://link.springer.com/article/10.1007/s00180-015-0570-1</a></p>
</div>
<div id="artificial-neural-network-ann-approach" class="section level1">
<h1>Artificial Neural Network (ANN) approach</h1>
<pre class="r"><code>scale01 &lt;- function(x){
  (x - min(x)) / (max(x) - min(x))
}


scale02 &lt;- function(y){
  y * (max(hard_$hardness) - min(hard_$hardness)) + min(hard_$hardness)
}

scale03 &lt;- function(i){
  i * (max(i) - min(i)) + min(i)
}

hard_ann &lt;- cbind(hard_$hardness,as_tibble(hard.clr)) %&gt;% 
  mutate_all(scale01) %&gt;% rename(&quot;hardness&quot; = &quot;hard_$hardness&quot;)

set.seed(1)
hard_ann_train &lt;- sample_frac(tbl = hard_ann, replace = FALSE, size = 0.80)
hard_ann_test &lt;- anti_join(hard_ann, hard_ann_train)</code></pre>
<pre class="r"><code>hard_ann_model1 &lt;- neuralnet(hardness ~ Al + Co + 
                         Cr + Cu + Fe +
                         Ni, data = hard_ann_train)</code></pre>
<pre class="r"><code>hard_ann_model2 &lt;- neuralnet(hardness ~ Al + Co + 
                         Cr + Cu + Fe +
                         Ni, data = hard_ann_train,
                         hidden = c(4, 1), 
                         act.fct = &#39;logistic&#39;,
                         rep = 10)</code></pre>
<pre class="r"><code>hard_ann_test_output1 &lt;- compute(hard_ann_model1, hard_ann_test[, 2:7])$net.result
hard_ann_test_output2 &lt;- compute(hard_ann_model2, hard_ann_test[, 2:7])$net.result


hard_ann_sse1 &lt;- sum((hard_ann_test_output1 - hard_ann_test[, 1])^2)/2
hard_ann_sse2 &lt;- sum((hard_ann_test_output2 - hard_ann_test[, 1])^2)/2


hard_ann_sse1</code></pre>
<pre><code>## [1] 0.01869546</code></pre>
<pre class="r"><code>hard_ann_sse2 # model 2 is more accurate</code></pre>
<pre><code>## [1] 0.01810635</code></pre>
<pre class="r"><code>dat &lt;- cbind(p = hard_ann_test_output2, hard_ann_test) %&gt;%
  arrange(hardness) %&gt;%
  mutate(row = row_number()) %&gt;% 
  mutate(prediction = scale02(p),
         hardness = scale02(hardness))

dat %&gt;% 
  pivot_longer(c(&quot;prediction&quot;,&quot;hardness&quot;)) %&gt;% 
  mutate(row = as.integer((row_number()-1)/2)) %&gt;% 
  ggplot(aes(row, value, colour = name, shape = name)) + 
  geom_point()+
  scale_color_discrete(name = paste(&quot;RMSE = &quot;, round(RMSE(dat$prediction,dat$hardness),2)))+
  scale_shape_discrete(name = paste(&quot;RMSE = &quot;, round(RMSE(dat$prediction,dat$hardness),2)))+
  labs(title = &quot;Unseen data observations ANN&quot;,
       subtitle = &quot;Comparing hardness artificial neural network regression and actual hardness on unseen data&quot;)+
  theme_bw()+
  theme(legend.position = c(0.8,0.2),
        legend.background = element_rect(fill = &quot;white&quot;, color = &quot;black&quot;))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code>hard_ann_results &lt;- compute(hard_ann_model2, hard_ann[, 2:7])$net.result</code></pre>
<pre class="r"><code>dat1 &lt;- cbind(predictions = hard_ann_results, hard_ann) %&gt;% 
  mutate(&quot;ANN prediction&quot; = scale02(predictions),
         hardness = scale02(hardness),
         distance = `ANN prediction` - hardness) %&gt;% 
  arrange(hardness) 
dat2 &lt;- dat1 %&gt;% 
  pivot_longer(c(&quot;ANN prediction&quot;,&quot;hardness&quot;), values_to = &quot;val&quot;, names_to = &quot;var&quot;) %&gt;% 
  mutate(row = as.integer((row_number()-1)/2))</code></pre>
<pre class="r"><code>g &lt;- cbind(data.frame(p = hard_ann_results) %&gt;% mutate(p = scale02(p)),hard_ann) %&gt;% 
  mutate(hardness = scale02(hardness))</code></pre>
<pre class="r"><code>dat2 %&gt;% 
  ggplot(aes(row, val, shape = var, colour = var)) +
  geom_point()+
  scale_color_discrete(type = c(&quot;dodgerblue&quot;, &quot;red&quot;),name = paste(&quot;RMSE = &quot;,round(RMSE(g$p, g$hardness),2)))+
  scale_shape_discrete(name = paste(&quot;RMSE = &quot;,round(RMSE(g$p, g$hardness),2)))+
  labs(title = &quot;Hardness prediction&quot;,
       subtitle = &quot;Comparing hardness artificial neural network regression and actual hardness&quot;,
       y = &quot;HV hardness&quot;,
       x = &quot;rank ordered by ascending hardness&quot;)+
  #annotate(&quot;text&quot;, y = 200, x = 25,label = paste(&quot;RMSE = &quot;,
  #  round(RMSE(hard$hardness, dat$predictions),2)
  #))+
  theme_bw()+
  theme(legend.position = c(0.8,0.2),
        legend.background = element_rect(fill = &quot;white&quot;, color = &quot;black&quot;))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="exploring-the-compositional-space" class="section level1">
<h1>Exploring the compositional space</h1>
<pre class="r"><code>g &lt;- hard_ann %&gt;%
  arrange(desc(hardness)) %&gt;%
  filter(hardness &gt; 0.8) %&gt;%
  pivot_longer(cols = colnames(hard_ann)[2:7])


#scale04(&quot;Co&quot;)
#lapply



g %&gt;%
  ggplot(aes(hardness, value, colour = name))+
  geom_line(size = 2)+
  theme_classic()</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<pre class="r"><code>g &lt;- cbind(predictions = hard_ann_results, hard_ann) %&gt;% 
  mutate(
    predictions = predictions * (max(hard_$hardness) - min(hard_$hardness)) + min(hard_$hardness),
    hardness = hardness * (max(hard_$hardness) - min(hard_$hardness)) + min(hard_$hardness),
    Al = Al * (max(hard_$Al) - min(hard_$Al)) + min(hard_$Al),
    Co = Co * (max(hard_$Co) - min(hard_$Co)) + min(hard_$Co),
    Cr = Cr * (max(hard_$Cr) - min(hard_$Cr)) + min(hard_$Cr),
    Cu = Cu * (max(hard_$Cu) - min(hard_$Cu)) + min(hard_$Cu),
    Fe = Fe * (max(hard_$Fe) - min(hard_$Fe)) + min(hard_$Fe),
    Ni = Ni * (max(hard_$Ni) - min(hard_$Ni)) + min(hard_$Ni)
  )

hard_ %&gt;% arrange(desc(hardness))</code></pre>
<pre><code>## # A tibble: 36 x 7
##       Al    Co    Cr    Cu    Fe    Ni hardness
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1  40    13.3   6.7  13.3  20     6.7      768
##  2  43     6    33     6     6     6        764
##  3  37.5  12.5  12.5  12.5  12.5  12.5      735
##  4  42.9  14.3  14.3   7.1   7.1  14.3      720
##  5  46.2  15.4   7.7   7.7  15.4   7.7      702
##  6  42.9  21.4   7.1   7.1   7.1  14.3      701
##  7  42.9   7.1  14.3   7.1  14.3  14.3      694
##  8  35.9  12.8  12.8  12.8  12.8  12.8      655
##  9  33.3  13.3  13.3  13.3  13.3  13.3      625
## 10  30.8  15.4  15.4   7.7  15.4  15.4      609
## # ... with 26 more rows</code></pre>
<pre class="r"><code>hard %&gt;% mutate(sum3 = Al + Co + Cr) %&gt;% 
  ggplot(aes(sum3, hardness))+
  geom_line()</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-27-2.png" width="672" /></p>
<pre class="r"><code>g %&gt;% filter(hardness&gt;650) %&gt;% # high copper, low nickel, cobalt good/midrange, iron good 
  ggplot(aes(hardness, colour = Fe))+
  geom_point(aes(y=Al))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-27-3.png" width="672" /></p>
<pre class="r"><code>p &lt;- g %&gt;% 
  mutate(unseen = 0) %&gt;% 
  add_row(predictions = 0, hardness = 0,Al = 40, Co = 20, Cr = 20, Cu = 0, Fe = 20, Ni = 0, unseen = 1) %&gt;% 
  add_row(predictions = 0, hardness = 0,Al = 41, Co = 19, Cr = 20, Cu = 0, Fe = 20, Ni = 0, unseen = 1) %&gt;% 
  add_row(predictions = 0, hardness = 0,Al = 42, Co = 18, Cr = 20, Cu = 0, Fe = 20, Ni = 0, unseen = 1) %&gt;% 
  add_row(predictions = 0, hardness = 0,Al = 41, Co = 20, Cr = 19, Cu = 0, Fe = 20, Ni = 0, unseen = 1) %&gt;% 
  add_row(predictions = 0, hardness = 0,Al = 42, Co = 20, Cr = 18, Cu = 0, Fe = 20, Ni = 0, unseen = 1) %&gt;% 
  add_row(predictions = 0, hardness = 0,Al = 41, Co = 20, Cr = 20, Cu = 0, Fe = 19, Ni = 0, unseen = 1) %&gt;% 
  add_row(predictions = 0, hardness = 0,Al = 42, Co = 20, Cr = 20, Cu = 0, Fe = 18, Ni = 0, unseen = 1) %&gt;% 
    add_row(predictions = 0, hardness = 0,Al = 43, Co = 17, Cr = 20, Cu = 0, Fe = 20, Ni = 0, unseen = 1) %&gt;% 
    add_row(predictions = 0, hardness = 0,Al = 44, Co = 16, Cr = 20, Cu = 0, Fe = 20, Ni = 0, unseen = 1) %&gt;% 
    add_row(predictions = 0, hardness = 0,Al = 45, Co = 15, Cr = 20, Cu = 0, Fe = 20, Ni = 0, unseen = 1) %&gt;% 
    add_row(predictions = 0, hardness = 0,Al = 46, Co = 18, Cr = 18, Cu = 0, Fe = 18, Ni = 0, unseen = 1) %&gt;% 
    add_row(predictions = 0, hardness = 0,Al = 43, Co = 19, Cr = 19, Cu = 0, Fe = 19, Ni = 0, unseen = 1) %&gt;% 
  add_row(predictions = 0, hardness = 0,Al = 49, Co = 17, Cr = 17, Cu = 0, Fe = 17, Ni = 0, unseen = 1) %&gt;% 
  add_row(predictions = 0, hardness = 0,Al = 30:50, Co = 30:10, Cr = 20, Cu = 0, Fe = 20, Ni = 0, unseen = 1) %&gt;% 
  add_row(predictions = 0, hardness = 0,Al = 30:50, Co = 20, Cr = 30:10, Cu = 0, Fe = 20, Ni = 0, unseen = 1) %&gt;%
  add_row(predictions = 0, hardness = 0,Al = 30:50, Co = 20, Cr = 20, Cu = 0, Fe = 30:10, Ni = 0, unseen = 1) %&gt;% 
  add_row(predictions = 0, hardness = 0,Al = 20:60, Co = 40:0, Cr = 20, Cu = 0, Fe = 20, Ni = 0, unseen = 1) 





predictions &lt;- compute(hard_ann_model2, p[, 3:8])$net.result

t &lt;- cbind(predictions,p[,2:9]) %&gt;% 
    mutate(
    predictions = predictions * (max(hard_$hardness) - min(hard_$hardness)) + min(hard_$hardness)) %&gt;% 
  distinct()


t_plot &lt;- t %&gt;% arrange(predictions) %&gt;% 
  mutate(rank = row_number()) %&gt;% 
  mutate(composition = paste(&quot;Al&quot;,round(Al),&quot;Co&quot;,round(Co),&quot;Cr&quot;,round(Cr),&quot;Cu&quot;,round(Cu),&quot;Fe&quot;,round(Fe),&quot;Ni&quot;,round(Ni))) %&gt;% 
  ggplot(aes(rank, predictions, colour = as.factor(unseen), shape = as.factor(unseen), group = composition))+
  geom_point()+
  scale_color_discrete(type = c(&quot;red&quot;, &quot;dodgerblue&quot;),name = &quot;unseen&quot;)+
  scale_shape_discrete(name = &quot;unseen&quot;)+
  labs(title = &quot;Hardness prediction in a virtual space&quot;,
       subtitle = &quot;Exploring a virtual compositional space with the ANN model&quot;,
       y = &quot;HV hardness&quot;,
       x = &quot;rank ordered by ascending hardness&quot;)+
  #annotate(&quot;text&quot;, y = 200, x = 25,label = paste(&quot;RMSE = &quot;,
  #  round(RMSE(hard$hardness, dat$predictions),2)
  #))+
  theme_bw()+
  theme(legend.position = c(0.8,0.2),
        legend.background = element_rect(fill = &quot;white&quot;, color = &quot;black&quot;))

plotly::ggplotly(t_plot)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,15,17,18,19,21,22,23,26,27,28,30,31,34,36,38,39,41,47,49,50,51,60,89,96],"y":[50.0118476337022,285.957522670609,287.463565051867,466.70918256443,466.709182564484,466.709182564484,466.709182564484,466.709182564484,466.709182565365,466.709182565627,466.709182567948,466.709182569353,466.709182608678,466.709182837691,466.709183130135,466.709183133244,466.709183311068,466.709183452186,466.709183582336,466.70919450763,466.70919660258,466.709200606289,466.709224043719,466.709268443507,466.710159948669,466.713501685336,466.740445530461,466.810307440344,466.950648910365,605.133876457119,605.476530786723,605.761628867577,605.761628881852,619.592756763271,853.562616895875,853.570682664899],"text":["rank:   1<br />predictions:  50.01185<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 13 Co 20 Cr 19 Cu 18 Fe 20 Ni 21","rank:   2<br />predictions: 285.95752<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 12 Co 21 Cr 19 Cu 7 Fe 21 Ni 33","rank:   3<br />predictions: 287.46357<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 6 Co 22 Cr 20 Cu 19 Fe 22 Ni 22","rank:   4<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 20 Co 19 Cr 18 Cu 17 Fe 19 Ni 19","rank:   5<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 24 Co 19 Cr 18 Cu 7 Fe 19 Ni 27","rank:   6<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 23 Co 31 Cr 17 Cu 6 Fe 18 Ni 19","rank:   7<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 23 Co 18 Cr 17 Cu 6 Fe 18 Ni 31","rank:   8<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 24 Co 26 Cr 18 Cu 7 Fe 19 Ni 20","rank:   9<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 24 Co 19 Cr 24 Cu 7 Fe 19 Ni 20","rank:  10<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 27 Co 9 Cr 20 Cu 9 Fe 22 Ni 23","rank:  11<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 31 Co 19 Cr 18 Cu 7 Fe 19 Ni 20","rank:  12<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 24 Co 19 Cr 18 Cu 7 Fe 26 Ni 20","rank:  15<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 27 Co 17 Cr 16 Cu 15 Fe 17 Ni 18","rank:  17<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 27 Co 22 Cr 20 Cu 9 Fe 22 Ni 10","rank:  18<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 35 Co 18 Cr 17 Cu 6 Fe 18 Ni 19","rank:  19<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 29 Co 17 Cr 16 Cu 15 Fe 17 Ni 17","rank:  21<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 43 Co 20 Cr 8 Cu 7 Fe 7 Ni 28","rank:  22<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 27 Co 22 Cr 10 Cu 9 Fe 22 Ni 23","rank:  23<br />predictions: 466.70918<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 23 Co 18 Cr 17 Cu 6 Fe 31 Ni 19","rank:  26<br />predictions: 466.70919<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 29 Co 17 Cr 23 Cu 6 Fe 17 Ni 19","rank:  27<br />predictions: 466.70920<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 31 Co 16 Cr 16 Cu 15 Fe 16 Ni 17","rank:  28<br />predictions: 466.70920<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 43 Co 27 Cr 8 Cu 7 Fe 7 Ni 20","rank:  30<br />predictions: 466.70922<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 25 Co 20 Cr 19 Cu 18 Fe 20 Ni 8","rank:  31<br />predictions: 466.70927<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 33 Co 16 Cr 15 Cu 14 Fe 16 Ni 17","rank:  34<br />predictions: 466.71016<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 35 Co 15 Cr 15 Cu 14 Fe 15 Ni 16","rank:  36<br />predictions: 466.71350<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 36 Co 15 Cr 15 Cu 14 Fe 15 Ni 16","rank:  38<br />predictions: 466.74045<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 38 Co 15 Cr 15 Cu 14 Fe 15 Ni 16","rank:  39<br />predictions: 466.81031<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 39 Co 15 Cr 14 Cu 13 Fe 15 Ni 15","rank:  41<br />predictions: 466.95065<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 43 Co 6 Cr 18 Cu 7 Fe 19 Ni 20","rank:  47<br />predictions: 605.13388<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 27 Co 22 Cr 20 Cu 9 Fe 9 Ni 23","rank:  49<br />predictions: 605.47653<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 25 Co 20 Cr 19 Cu 18 Fe 7 Ni 21","rank:  50<br />predictions: 605.76163<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 43 Co 19 Cr 18 Cu 7 Fe 6 Ni 20","rank:  51<br />predictions: 605.76163<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 46 Co 7 Cr 33 Cu 7 Fe 7 Ni 8","rank:  60<br />predictions: 619.59276<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 23 Co 18 Cr 27 Cu 6 Fe 18 Ni 19","rank:  89<br />predictions: 853.56262<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 45 Co 21 Cr 9 Cu 8 Fe 21 Ni 9","rank:  96<br />predictions: 853.57068<br />as.factor(unseen): 0<br />as.factor(unseen): 0<br />composition: Al 41 Co 18 Cr 7 Cu 16 Fe 25 Ni 6"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)"}},"hoveron":"points","name":"0","legendgroup":"0","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[13,14,16,20,24,25,29,32,33,35,37,40,42,43,44,45,46,48,52,53,54,55,56,57,58,59,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,90,91,92,93,94,95,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120],"y":[466.709182581333,466.70918258432,466.709182674978,466.709183186595,466.709183913533,466.709186078143,466.709202457185,466.709295394235,466.709823416355,466.712826271416,466.729914224876,466.827144937389,467.378545953047,470.440946692004,485.63735907393,532.839911878681,584.185679270701,605.264333450043,605.761632159359,605.761661640286,605.761955861058,605.762099082574,605.764891320614,605.794176374298,606.086112833006,608.9746095731,621.712592901563,629.732865754964,635.55162703042,643.49043466649,644.096114021266,644.702130889719,645.308473108427,645.915128485318,646.52208480066,647.129329808639,647.736854656602,648.365062636112,668.273080660025,711.352595209482,776.160212237845,776.714004154854,777.24612998623,777.778211224615,778.310240557139,778.842207055376,779.374099793939,779.905907852011,780.437620314285,780.969226271898,781.500714823363,849.937986868653,853.171892051056,853.530658122612,853.566670755399,853.570280586122,853.570642399028,853.570678663219,853.570682297944,853.570682662249,882.935459129906,897.550706222626,927.279917226522,936.231324117359,939.356798506386,942.277649697616,942.964518005944,943.009920299136,943.12499072038,943.162424911577,943.170000003205,943.171154262837,943.173189709883,943.173664311764,943.173774973452,943.173800776129,943.173806792467,943.17380819528,943.17380852237,943.173808598636,943.173808616419,943.173808620566,943.173808621533,943.173808621758],"text":["rank:  13<br />predictions: 466.70918<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 21 Co 39 Cr 20 Cu 0 Fe 20 Ni 0","rank:  14<br />predictions: 466.70918<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 22 Co 38 Cr 20 Cu 0 Fe 20 Ni 0","rank:  16<br />predictions: 466.70918<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 23 Co 37 Cr 20 Cu 0 Fe 20 Ni 0","rank:  20<br />predictions: 466.70918<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 24 Co 36 Cr 20 Cu 0 Fe 20 Ni 0","rank:  24<br />predictions: 466.70918<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 20 Co 40 Cr 20 Cu 0 Fe 20 Ni 0","rank:  25<br />predictions: 466.70919<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 25 Co 35 Cr 20 Cu 0 Fe 20 Ni 0","rank:  29<br />predictions: 466.70920<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 26 Co 34 Cr 20 Cu 0 Fe 20 Ni 0","rank:  32<br />predictions: 466.70930<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 27 Co 33 Cr 20 Cu 0 Fe 20 Ni 0","rank:  33<br />predictions: 466.70982<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 28 Co 32 Cr 20 Cu 0 Fe 20 Ni 0","rank:  35<br />predictions: 466.71283<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 29 Co 31 Cr 20 Cu 0 Fe 20 Ni 0","rank:  37<br />predictions: 466.72991<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 30 Co 30 Cr 20 Cu 0 Fe 20 Ni 0","rank:  40<br />predictions: 466.82714<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 31 Co 29 Cr 20 Cu 0 Fe 20 Ni 0","rank:  42<br />predictions: 467.37855<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 32 Co 28 Cr 20 Cu 0 Fe 20 Ni 0","rank:  43<br />predictions: 470.44095<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 33 Co 27 Cr 20 Cu 0 Fe 20 Ni 0","rank:  44<br />predictions: 485.63736<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 34 Co 26 Cr 20 Cu 0 Fe 20 Ni 0","rank:  45<br />predictions: 532.83991<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 35 Co 25 Cr 20 Cu 0 Fe 20 Ni 0","rank:  46<br />predictions: 584.18568<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 36 Co 24 Cr 20 Cu 0 Fe 20 Ni 0","rank:  48<br />predictions: 605.26433<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 37 Co 23 Cr 20 Cu 0 Fe 20 Ni 0","rank:  52<br />predictions: 605.76163<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 32 Co 20 Cr 28 Cu 0 Fe 20 Ni 0","rank:  53<br />predictions: 605.76166<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 33 Co 20 Cr 27 Cu 0 Fe 20 Ni 0","rank:  54<br />predictions: 605.76196<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 34 Co 20 Cr 26 Cu 0 Fe 20 Ni 0","rank:  55<br />predictions: 605.76210<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 31 Co 20 Cr 29 Cu 0 Fe 20 Ni 0","rank:  56<br />predictions: 605.76489<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 35 Co 20 Cr 25 Cu 0 Fe 20 Ni 0","rank:  57<br />predictions: 605.79418<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 36 Co 20 Cr 24 Cu 0 Fe 20 Ni 0","rank:  58<br />predictions: 606.08611<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 37 Co 20 Cr 23 Cu 0 Fe 20 Ni 0","rank:  59<br />predictions: 608.97461<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 38 Co 20 Cr 22 Cu 0 Fe 20 Ni 0","rank:  61<br />predictions: 621.71259<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 38 Co 22 Cr 20 Cu 0 Fe 20 Ni 0","rank:  62<br />predictions: 629.73287<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 30 Co 20 Cr 30 Cu 0 Fe 20 Ni 0","rank:  63<br />predictions: 635.55163<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 39 Co 20 Cr 21 Cu 0 Fe 20 Ni 0","rank:  64<br />predictions: 643.49043<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 30 Co 20 Cr 20 Cu 0 Fe 30 Ni 0","rank:  65<br />predictions: 644.09611<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 31 Co 20 Cr 20 Cu 0 Fe 29 Ni 0","rank:  66<br />predictions: 644.70213<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 32 Co 20 Cr 20 Cu 0 Fe 28 Ni 0","rank:  67<br />predictions: 645.30847<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 33 Co 20 Cr 20 Cu 0 Fe 27 Ni 0","rank:  68<br />predictions: 645.91513<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 34 Co 20 Cr 20 Cu 0 Fe 26 Ni 0","rank:  69<br />predictions: 646.52208<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 35 Co 20 Cr 20 Cu 0 Fe 25 Ni 0","rank:  70<br />predictions: 647.12933<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 36 Co 20 Cr 20 Cu 0 Fe 24 Ni 0","rank:  71<br />predictions: 647.73685<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 37 Co 20 Cr 20 Cu 0 Fe 23 Ni 0","rank:  72<br />predictions: 648.36506<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 38 Co 20 Cr 20 Cu 0 Fe 22 Ni 0","rank:  73<br />predictions: 668.27308<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 39 Co 21 Cr 20 Cu 0 Fe 20 Ni 0","rank:  74<br />predictions: 711.35260<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 39 Co 20 Cr 20 Cu 0 Fe 21 Ni 0","rank:  75<br />predictions: 776.16021<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 40 Co 20 Cr 20 Cu 0 Fe 20 Ni 0","rank:  76<br />predictions: 776.71400<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 41 Co 20 Cr 20 Cu 0 Fe 19 Ni 0","rank:  77<br />predictions: 777.24613<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 42 Co 20 Cr 20 Cu 0 Fe 18 Ni 0","rank:  78<br />predictions: 777.77821<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 43 Co 20 Cr 20 Cu 0 Fe 17 Ni 0","rank:  79<br />predictions: 778.31024<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 44 Co 20 Cr 20 Cu 0 Fe 16 Ni 0","rank:  80<br />predictions: 778.84221<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 45 Co 20 Cr 20 Cu 0 Fe 15 Ni 0","rank:  81<br />predictions: 779.37410<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 46 Co 20 Cr 20 Cu 0 Fe 14 Ni 0","rank:  82<br />predictions: 779.90591<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 47 Co 20 Cr 20 Cu 0 Fe 13 Ni 0","rank:  83<br />predictions: 780.43762<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 48 Co 20 Cr 20 Cu 0 Fe 12 Ni 0","rank:  84<br />predictions: 780.96923<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 49 Co 20 Cr 20 Cu 0 Fe 11 Ni 0","rank:  85<br />predictions: 781.50071<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 50 Co 20 Cr 20 Cu 0 Fe 10 Ni 0","rank:  86<br />predictions: 849.93799<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 42 Co 20 Cr 18 Cu 0 Fe 20 Ni 0","rank:  87<br />predictions: 853.17189<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 43 Co 20 Cr 17 Cu 0 Fe 20 Ni 0","rank:  88<br />predictions: 853.53066<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 44 Co 20 Cr 16 Cu 0 Fe 20 Ni 0","rank:  90<br />predictions: 853.56667<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 45 Co 20 Cr 15 Cu 0 Fe 20 Ni 0","rank:  91<br />predictions: 853.57028<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 46 Co 20 Cr 14 Cu 0 Fe 20 Ni 0","rank:  92<br />predictions: 853.57064<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 47 Co 20 Cr 13 Cu 0 Fe 20 Ni 0","rank:  93<br />predictions: 853.57068<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 48 Co 20 Cr 12 Cu 0 Fe 20 Ni 0","rank:  94<br />predictions: 853.57068<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 49 Co 20 Cr 11 Cu 0 Fe 20 Ni 0","rank:  95<br />predictions: 853.57068<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 50 Co 20 Cr 10 Cu 0 Fe 20 Ni 0","rank:  97<br />predictions: 882.93546<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 41 Co 19 Cr 20 Cu 0 Fe 20 Ni 0","rank:  98<br />predictions: 897.55071<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 41 Co 20 Cr 19 Cu 0 Fe 20 Ni 0","rank:  99<br />predictions: 927.27992<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 42 Co 18 Cr 20 Cu 0 Fe 20 Ni 0","rank: 100<br />predictions: 936.23132<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 43 Co 19 Cr 19 Cu 0 Fe 19 Ni 0","rank: 101<br />predictions: 939.35680<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 43 Co 17 Cr 20 Cu 0 Fe 20 Ni 0","rank: 102<br />predictions: 942.27765<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 44 Co 16 Cr 20 Cu 0 Fe 20 Ni 0","rank: 103<br />predictions: 942.96452<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 45 Co 15 Cr 20 Cu 0 Fe 20 Ni 0","rank: 104<br />predictions: 943.00992<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 46 Co 18 Cr 18 Cu 0 Fe 18 Ni 0","rank: 105<br />predictions: 943.12499<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 46 Co 14 Cr 20 Cu 0 Fe 20 Ni 0","rank: 106<br />predictions: 943.16242<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 47 Co 13 Cr 20 Cu 0 Fe 20 Ni 0","rank: 107<br />predictions: 943.17000<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 49 Co 17 Cr 17 Cu 0 Fe 17 Ni 0","rank: 108<br />predictions: 943.17115<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 48 Co 12 Cr 20 Cu 0 Fe 20 Ni 0","rank: 109<br />predictions: 943.17319<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 49 Co 11 Cr 20 Cu 0 Fe 20 Ni 0","rank: 110<br />predictions: 943.17366<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 50 Co 10 Cr 20 Cu 0 Fe 20 Ni 0","rank: 111<br />predictions: 943.17377<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 51 Co 9 Cr 20 Cu 0 Fe 20 Ni 0","rank: 112<br />predictions: 943.17380<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 52 Co 8 Cr 20 Cu 0 Fe 20 Ni 0","rank: 113<br />predictions: 943.17381<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 53 Co 7 Cr 20 Cu 0 Fe 20 Ni 0","rank: 114<br />predictions: 943.17381<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 54 Co 6 Cr 20 Cu 0 Fe 20 Ni 0","rank: 115<br />predictions: 943.17381<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 55 Co 5 Cr 20 Cu 0 Fe 20 Ni 0","rank: 116<br />predictions: 943.17381<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 56 Co 4 Cr 20 Cu 0 Fe 20 Ni 0","rank: 117<br />predictions: 943.17381<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 57 Co 3 Cr 20 Cu 0 Fe 20 Ni 0","rank: 118<br />predictions: 943.17381<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 58 Co 2 Cr 20 Cu 0 Fe 20 Ni 0","rank: 119<br />predictions: 943.17381<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 59 Co 1 Cr 20 Cu 0 Fe 20 Ni 0","rank: 120<br />predictions: 943.17381<br />as.factor(unseen): 1<br />as.factor(unseen): 1<br />composition: Al 60 Co 0 Cr 20 Cu 0 Fe 20 Ni 0"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(30,144,255,1)","opacity":1,"size":5.66929133858268,"symbol":"triangle-up","line":{"width":1.88976377952756,"color":"rgba(30,144,255,1)"}},"hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Hardness prediction in a virtual space","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.95,125.95],"tickmode":"array","ticktext":["0","25","50","75","100","125"],"tickvals":[0,25,50,75,100,125],"categoryorder":"array","categoryarray":["0","25","50","75","100","125"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"rank ordered by ascending hardness","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[5.35374958429942,987.831906671161],"tickmode":"array","ticktext":["250","500","750"],"tickvals":[250,500,750],"categoryorder":"array","categoryarray":["250","500","750"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"HV hardness","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"rgba(0,0,0,1)","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.96751968503937},"annotations":[{"text":"unseen","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"54fc31e3639e":{"x":{},"y":{},"colour":{},"shape":{},"type":"scatter"}},"cur_data":"54fc31e3639e","visdat":{"54fc31e3639e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>hard %&gt;% filter(Co&lt;15,Al&gt;40) %&gt;% 
  arrange(desc(hardness))</code></pre>
<pre><code>## # A tibble: 5 x 7
##      Al    Co    Cr    Cu    Fe    Ni hardness
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
## 1  43     6    33     6     6     6        764
## 2  42.9  14.3  14.3   0    14.3  14.3      740
## 3  42.9  14.3  14.3   7.1   7.1  14.3      720
## 4  42.9   7.1  14.3   7.1  14.3  14.3      694
## 5  42.9  14.3   7.1   7.1   7.1  21.4      591</code></pre>
</div>
