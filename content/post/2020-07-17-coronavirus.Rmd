---
title: Coronavirus
author: ~
date: '2020-07-17'
slug: coronavirus
categories: []
tags: []
---

https://www.ecdc.europa.eu/en/publications-data/download-todays-data-geographic-distribution-covid-19-cases-worldwide

```{r setup, include=FALSE, message=FALSE,warning=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning = FALSE, message = FALSE)
```

Libraries, reading in of the data and light tidying.

```{r}
library(tidyverse)
library(lubridate)
library(httr)
library(zoo)
library(plotly)
library(ggrepel)

theme_set(theme_minimal())

covid_raw <- read.csv("https://opendata.ecdc.europa.eu/covid19/casedistribution/csv", na.strings = "", fileEncoding = "UTF-8-BOM") %>% 
  rename("date" = dateRep,
         "country" = countriesAndTerritories,
         "code" = countryterritoryCode,
         "population2019" = popData2019,
         "continent" = continentExp,
         "cases_rate" = Cumulative_number_for_14_days_of_COVID.19_cases_per_100000)
```

Defining of the G8 and G20 nations

```{r}
covid_data <- read.csv("covid_data.csv")

G8 <- c("FRA","DEU","ITA","JPN","GBR","USA","RUS","CDN")

G20 <- c("ARG","BRA","AUS","CAN","CHN","FRA","DEU","IND","IDN","ITA","JPN","KOR","MEX","RUS","SAU","ZAF","TUR","GBR","USA")


```

Getting the data ready for use.

```{r}
covid <- covid_raw %>%
  mutate(date=dmy(date),
         country= case_when(
           country == "United_Kingdom" ~ "UK",
           country == "United_States_of_America" ~ "USA",
           TRUE ~ country
         )) %>% 
  mutate(country = sub("_"," ",country)) %>% 
  filter(cases_rate>0)
```

Creating dataframes specific to G8 and G20 nations.

```{r}
covid_g8 <- covid %>% 
  filter(code %in% c(G8))

covid_g20 <- covid %>% 
  filter(code %in% c(G20))
```


Plotting our graphs.

```{r}
covid_g8 %>% 
  ggplot(aes(date, cases_rate, colour = country))+
  geom_line()+
  theme(legend.position = "bottom")+
  labs(colour = "Country Code",
       x="",
       y="No. cases per 100,000 people",
       title = "Active covid-19 cases per 100,000 people in the G8")

covid_g20 %>% 
  ggplot(aes(date, cases_rate, colour = country))+
  geom_line()+
  theme(legend.position = "bottom")+
  geom_vline(xintercept=ymd(20200525), lty=2)+
  #annotate("text", label = "George Floyd death", angle = 90, x = ymd(20200525)-1,y=150)+
  labs(colour = "Country Code",
       x="",
       y="No. cases per 100,000 people",
       title = "Active covid-19 cases per 100,000 people in the G20")


ggplotly(covid_g20 %>% 
  ggplot(aes(date, cases_rate, colour = country))+
  geom_line()+
  theme(legend.position = "bottom")+
  geom_vline(xintercept=ymd(20200525))+
  labs(colour = "Country Code",
       x="",
       y="No. cases per 100,000 people",
       title = "Active covid-19 cases per 100,000 people in the G20")
)



```


