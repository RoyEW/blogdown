---
title: Compositional analysis
author: ~
date: '2020-07-03'
slug: compositional-analysis
categories: []
tags: []
---



<pre class="r"><code>divide01 &lt;- function(x){
  return(x/100)
}
head(data)</code></pre>
<pre><code>##                                                                             
## 1 function (..., list = character(), package = NULL, lib.loc = NULL,        
## 2     verbose = getOption(&quot;verbose&quot;), envir = .GlobalEnv, overwrite = TRUE) 
## 3 {                                                                         
## 4     fileExt &lt;- function(x) {                                              
## 5         db &lt;- grepl(&quot;\\\\.[^.]+\\\\.(gz|bz2|xz)$&quot;, x)                     
## 6         ans &lt;- sub(&quot;.*\\\\.&quot;, &quot;&quot;, x)</code></pre>
<pre class="r"><code>data &lt;- read.csv(&quot;hardness.csv&quot;) %&gt;% 
  mutate(Al=divide01(Al),
         Co=divide01(Co),
         Cr=divide01(Cr),
         Cu=divide01(Cu),
         Fe=divide01(Fe),
         Ni=divide01(Ni))
data_ordered &lt;- read.csv(&quot;hardness.csv&quot;) %&gt;% 
  mutate(Al=divide01(Al),
         Co=divide01(Co),
         Cr=divide01(Cr),
         Cu=divide01(Cu),
         Fe=divide01(Fe),
         Ni=divide01(Ni)) %&gt;% 
  arrange(desc(hardness))

closed &lt;- clo(data, parts = 1:6,total=100)
cx &lt;- acomp(data, c(&quot;Al&quot;,&quot;Co&quot;,&quot;Cr&quot;))
plot(cx)</code></pre>
<p><img src="/post/2020-07-03-compositional-analysis_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>xc &lt;- acomp(data, c(&quot;Al&quot;,&quot;Co&quot;,&quot;Cr&quot;,&quot;Cu&quot;,&quot;Fe&quot;,&quot;Ni&quot;))
xc_ordered &lt;- acomp(data_ordered, c(&quot;Al&quot;,&quot;Co&quot;,&quot;Cr&quot;,&quot;Cu&quot;,&quot;Fe&quot;,&quot;Ni&quot;))
plot(xc)</code></pre>
<p><img src="/post/2020-07-03-compositional-analysis_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<pre class="r"><code>barplot.acomp(xc)</code></pre>
<p><img src="/post/2020-07-03-compositional-analysis_files/figure-html/unnamed-chunk-2-3.png" width="672" /></p>
<p>Order of hardness desc</p>
<pre class="r"><code>barplot.acomp(xc_ordered)</code></pre>
<p><img src="/post/2020-07-03-compositional-analysis_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Possibly drop copper and nickel</p>
<pre class="r"><code>dd &lt;-
  read.table(text = content(GET(&quot;https://gist.githubusercontent.com/MrFlick/c1183c911bc5398105d4/raw/715868fba2d0d17a61a8081de17c468bbc525ab1/elements.txt&quot;)),
  sep = &quot;,&quot;,
  header = TRUE) %&gt;%
  mutate(
    ElementName = ifelse(ElementName == &quot;Sulfer&quot;, &quot;Sulfur&quot;, ElementName),
    ElementName = ifelse(ElementName == &quot;Phosphorous&quot;, &quot;Phosphorus&quot;, ElementName),
    ElementName = ifelse(ElementName == &quot;Flourine&quot;, &quot;Fluorine&quot;, ElementName))

data &lt;- read_excel(&quot;melting_points.xlsx&quot;, sheet = 2)

colnames(dd) &lt;- c(colnames(dd)[1:7], &quot;element&quot;, colnames(dd)[9:13])

data &lt;- dd %&gt;% 
  left_join(data, by = &quot;element&quot;)


head(dd)</code></pre>
<pre><code>##   AtomicNumber AtomicWeight GroupNumber      GroupName Period   Block
## 1            1            1           5     Non-metals      1 s-block
## 2            2            0           4    Noble gases     NA        
## 3            3            0           0   Alkali earth     NA        
## 4            4            0           1 Alkaline earth     NA        
## 5            5            0           3     Metalloids     NA        
## 6            6            0           5     Non-metals     NA        
##   CASRegistryID   element ElementSymbol DiscoveryDate  DiscovererName Row
## 1     1333-74-0  Hydrogen             H          1766 Henry Cavendish   1
## 2                  Helium            He            NA                   1
## 3                 Lithium            Li            NA                   2
## 4               Beryllium            Be            NA                   2
## 5                   Boron             B            NA                   2
## 6                  Carbon             C            NA                   2
##   Column
## 1      1
## 2     18
## 3      1
## 4      2
## 5     13
## 6     14</code></pre>
<pre class="r"><code>dd %&gt;%
  left_join(data, by = &quot;element&quot;, ) %&gt;%
  ggplot(aes(Column.x,-Row.x)) +
  geom_tile(aes(fill = crystal_structure), color = &quot;black&quot;) +
  geom_text(aes(label = symbol)) +
  theme_void() +
  labs(fill = &quot;Crystal Structure&quot;) +
  annotate(
    &quot;text&quot;,
    x = 7,
    y = 0.2,
    label = &quot;Periodic Table of the elements&quot;,
    size = 5)</code></pre>
<p><img src="/post/2020-07-03-compositional-analysis_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>dd %&gt;%
  left_join(data, by = &quot;element&quot;) %&gt;%
  mutate(
    log_cte = log(CTE),
    new_cte = CTE * 1000000,
    is_extreme = ifelse(new_cte &lt; 10, 0, 1)
  ) %&gt;%
  ggplot(aes(Column.x,-Row.x)) +
  geom_tile(aes(fill = log10(CTE)), color = &quot;black&quot;, size = 1) +
  geom_text(aes(label = symbol), colour = &quot;black&quot;) +
  geom_text(aes(label = new_cte), colour = &quot;black&quot;, nudge_y = -0.3) +
  scale_fill_gradient(low = &quot;red&quot;, high = &quot;green&quot;) +
  theme_void() +
  labs(fill = expression(paste(&quot;CTE&quot;, 10 ^ 6))) +
  annotate(
    &quot;text&quot;,
    x = 7,
    y = 0.2,
    label = &quot;Periodic Table of the elements&quot;,
    size = 5)</code></pre>
<p><img src="/post/2020-07-03-compositional-analysis_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre class="r"><code>f1 &lt;- function(x){
  return(1/(16.6*3*(x+273)))
}

f2 &lt;- function(){
  ifelse(x&lt;0,-x,-x)
}
library(plotly)
library(ggrepel)
data %&gt;% 
  ggplot(aes(mp, CTE, label=element))+
  geom_point()+
  stat_function(fun=f1)+
  lims(
    x=c(1500,4000),
    y=c(0,0.000025)
  )+
  theme(legend.position = &quot;none&quot;)+
  ggrepel::geom_text_repel()+
  theme_classic()</code></pre>
<p><img src="/post/2020-07-03-compositional-analysis_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>library(broom)
augment(glm(CTE ~ mp, data = data, family = &quot;binomial&quot;)) %&gt;%
  ggplot(aes(mp,CTE))+
  geom_point()+
  geom_point(aes(mp, .fitted), colour= &quot;blue&quot;)+
  theme_classic()</code></pre>
<p><img src="/post/2020-07-03-compositional-analysis_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
